
const images = {
  "Niveles": [
    { "url": "url(css/daltonismcss/images/levels/Nivel2.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel3.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel4.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel5.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel6.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel7.gif" },
    { "url": "url(css/daltonismcss/images/levels/Nivel8.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel9.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel10.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel11.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel12.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel13.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel14.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel15.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel16.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel17.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel18.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel19.gif)" },
    { "url": "url(css/daltonismcss/images/levels/Nivel20.gif)" },
  ],
  "Orignales": [
    { "url": "url(css/daltonismcss/images/Normal/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Normal/Pajaro2.png)" },
  ],
  "Deutaronapia": [
    { "url": "url(css/daltonismcss/images/Deutaronapia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Deutaronapia/Pajaro2.png)" },
  ],
  "Protanopia": [
    { "url": "url(css/daltonismcss/images/Protanopia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Protanopia/Pajaro2.png)" },
  ],
  "Tritanopia": [
    { "url": "url(css/daltonismcss/images/Tritanopia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Tritanopia/Pajaro2.png)" },
  ],
  "Deutanomalia": [
    { "url": "url(css/daltonismcss/images/Deutanomalia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Deutanomalia/Pajaro2.png)" },
  ],
  "Tritanomalia": [
    { "url": "url(css/daltonismcss/images/Tritanomalia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Tritanomalia/Pajaro2.png)" },
  ],
  "Protanomalia": [
    { "url": "url(css/daltonismcss/images/Protanomalia/Pajaro.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Serpiente.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Buho.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Caracol.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Ganzo.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Leon.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Pato.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Perro.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Tortuga.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Gallo.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Coco.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Caballo.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Gato.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Pez.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Garza.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Iguana.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Perro2.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Rana.png)" },
    { "url": "url(css/daltonismcss/images/Protanomalia/Pajaro2.png)" },
  ],

}
const positionsButtons = {
  "positions": [
    { "top": "35%", "left": "6%" },
    { "top": "35%", "left": "50%" },
    { "top": "35%", "left": "80%" },
    { "top": "70%", "left": "6%" },
    { "top": "70%", "left": "50%" },
    { "top": "70%", "left": "80%" },
    { "top": "50%", "left": "28%" },
  ]
}
var contador = 0;
var deunapiacontador = 0;
var protnapiaContador = 0;
var tritanomaliaContador = 0;
var tritanopiaContador = 0;
var deumaliaContador = 0;
var protanomaliaContador = 0;
var normalContador = 0;


function changeImage(posicion) {
  deunapiaButton.style.backgroundImage = images.Deutaronapia[posicion - 1].url;
  protnapiaButton.style.backgroundImage = images.Protanopia[posicion - 1].url;
  tritanopiaButton.style.backgroundImage = images.Tritanopia[posicion - 1].url;
  deumaliaButton.style.backgroundImage = images.Deutanomalia[posicion - 1].url;
  tritanomaliaButton.style.backgroundImage = images.Tritanomalia[posicion - 1].url;
  protanomaliaButton.style.backgroundImage = images.Protanomalia[posicion - 1].url;
  exampleImage.style.backgroundImage = images.Orignales[posicion - 1].url;
  level.style.backgroundImage = images.Niveles[posicion - 1].url;

}
function randomPosition() {
  var myArray = ['0', '1', '2', '3', '4', '5', '6'];
  var i, j, k;
  for (i = myArray.length; i; i--) {
    j = Math.floor(Math.random() * i);
    k = myArray[i - 1];
    myArray[i - 1] = myArray[j];
    myArray[j] = k;
  };
  deunapiaButton.style.top = positionsButtons.positions[myArray[0]].top;
  deunapiaButton.style.left = positionsButtons.positions[myArray[0]].left;
  protnapiaButton.style.top = positionsButtons.positions[myArray[1]].top;
  protnapiaButton.style.left = positionsButtons.positions[myArray[1]].left;
  tritanopiaButton.style.top = positionsButtons.positions[myArray[2]].top;
  tritanopiaButton.style.left = positionsButtons.positions[myArray[2]].left;
  deumaliaButton.style.top = positionsButtons.positions[myArray[3]].top;
  deumaliaButton.style.left = positionsButtons.positions[myArray[3]].left;
  tritanomaliaButton.style.top = positionsButtons.positions[myArray[4]].top;
  tritanomaliaButton.style.left = positionsButtons.positions[myArray[4]].left;
  protanomaliaButton.style.top = positionsButtons.positions[myArray[5]].top;
  protanomaliaButton.style.left = positionsButtons.positions[myArray[5]].left;
  normalButton.style.top = positionsButtons.positions[myArray[6]].top;
  normalButton.style.left = positionsButtons.positions[myArray[6]].left;

};

function endGame(x, e) {
  if (x == 20) {
    var answersDaltonism;
    var resultado;
    deunapiaButton.style.visibility = "hidden";
    protnapiaButton.style.visibility = "hidden";
    tritanopiaButton.style.visibility = "hidden";
    deumaliaButton.style.visibility = "hidden";
    tritanomaliaButton.style.visibility = "hidden";
    protanomaliaButton.style.visibility = "hidden";
    exampleImage.style.visibility = "hidden";
    level.style.visibility = "hidden";
    normalButton.style.visibility = "hidden";
    monkey.style.visibility = "hidden";
    elijeEste.style.visibility = "hidden";
    if (normalContador > deumaliaContador && normalContador > deunapiacontador
      && normalContador > protanomaliaContador && normalContador > protnapiaContador
      && normalContador > tritanomaliaContador && normalContador > tritanopiaContador) {
      resultado = "Normal";
    } else if (deumaliaContador > normalContador && deumaliaContador > deunapiacontador &&
      deumaliaContador > protanomaliaContador && deumaliaContador > protnapiaContador &&
      deumaliaContador > tritanomaliaContador && deumaliaContador > tritanopiaContador) {
      resultado = "deutoronomalia";

    } else if (deunapiacontador > normalContador && deunapiacontador > deumaliaContador &&
      deunapiacontador > protanomaliaContador && deunapiacontador > protnapiaContador &&
      deunapiacontador > tritanomaliaContador && deunapiacontador > tritanopiaContador) {
      resultado = "deutaronapia";

    } else if (protanomaliaContador > normalContador && protanomaliaContador > deumaliaContador &&
      protanomaliaContador > deunapiacontador && protanomaliaContador > protnapiaContador &&
      protanomaliaContador > tritanomaliaContador && protanomaliaContador > tritanopiaContador) {
      resultado = "protanomalia";

    } else if (protnapiaContador > normalContador && protnapiaContador > deumaliaContador &&
      protnapiaContador > deunapiacontador && protnapiaContador > protanomaliaContador &&
      protnapiaContador > tritanomaliaContador && protnapiaContador > tritanopiaContador) {
      resultado = "protanopia";

    } else if (tritanomaliaContador > normalContador && tritanomaliaContador > deumaliaContador &&
      tritanomaliaContador > deunapiacontador && tritanomaliaContador > protanomaliaContador &&
      tritanomaliaContador > protnapiaContador && tritanomaliaContador > tritanopiaContador) {
      resultado = "tritanomalia";

    } else if (tritanopiaContador > normalContador && tritanopiaContador > deumaliaContador &&
      tritanopiaContador > deunapiacontador && tritanopiaContador > protanomaliaContador &&
      tritanopiaContador > protnapiaContador && tritanopiaContador > tritanomaliaContador) {
      resultado = "tritanopia";

    } else
      resultado = "Inconcluso";

    answersDaltonism = {
      type: 6,
      testName: "Prueba de daltonismo",
      normales: normalContador,
      deutoronomalia: deumaliaContador,
      deutaronapia: deunapiacontador,
      protanomalia: protanomaliaContador,
      protanopia: protnapiaContador,
      tritanomalia: tritanomaliaContador,
      tritanopia: tritanopiaContador,
      resultado: resultado
    };
    localStorage.setItem('dippacAnswers', JSON.stringify(answersDaltonism));
    sendAnswer(e);
    window.open("index.php?controlador=Daltonism&accion=endGameScreen", "_self");
  };

}
function sendAnswer(e) {
  e.preventDefault()
  $.ajax({
    url: "index.php?controlador=Daltonism&accion=saveAnswer",
    type: "POST",
    data: {
      data: JSON.parse(localStorage.getItem('dippacAnswers'))
    },
    dataType: "json"
  }).done(function (respuesta) {
    console.log(respuesta);
  }).fail(function (error) {
    console.log(error);
  });
}

function closeGame() {
  window.close();

}

$(function () {
  $("#startbutton").on('click', function (event) {
    window.open('index.php?controlador=Daltonism&accion=gameScreen', '_blank', "width=" + screen.availWidth + ",height=" + screen.availHeight);

  });

});


$(function () {
  var exampleImage = document.getElementById("exampleImage");
  var deunapiaButton = document.getElementById("deunapiaButton");
  var protnapiaButton = document.getElementById("protnapiaButton");
  var tritanopiaButton = document.getElementById("tritanopiaButton");
  var deumaliaButton = document.getElementById("deumaliaButton");
  var tritanomaliaButton = document.getElementById("tritanomaliaButton");
  var protanomaliaButton = document.getElementById("protanomaliaButton");
  var normalButton = document.getElementById("normalButton");
  var level = document.getElementById("level");
  var monkey = document.getElementById("monkey");
  var elijeEste = document.getElementById("elijeEste");

  $("#deunapiaButton").on('click', function (event) {
    contador = contador + 1;
    deunapiacontador = deunapiacontador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);

  });
  $("#protnapiaButton").on('click', function (event) {
    contador = contador + 1;
    protnapiaContador = protnapiaContador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);

  });
  $("#tritanopiaButton").on('click', function (event) {
    contador = contador + 1;
    tritanopiaContador = tritanopiaContador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);
  });
  $("#deumaliaButton").on('click', function (event) {
    contador = contador + 1;
    deumaliaContador = deumaliaContador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);
  });
  $("#tritanomaliaButton").on('click', function (event) {
    contador = contador + 1;
    tritanomaliaContador = tritanomaliaContador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);
  });
  $("#protanomaliaButton").on('click', function (event) {
    contador = contador + 1;
    protanomaliaContador = protanomaliaContador + 1;
    endGame(contador, event);
    randomPosition();
    changeImage(contador);
  });
  $("#normalButton").on('click', function (event) {
    contador = contador + 1;
    normalContador = normalContador + 1;
    endGame(contador, event);
    randomPosition();
    console.log(normalContador);
    changeImage(contador);
  });

  $("#endGameButton").on('click', function (event) {
    console.log(normalContador);
    closeGame();
  });


});










